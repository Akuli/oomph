#!/bin/bash
# Make sure self-hosted compiler can do something to all oomph files, including itself.
# Currently, it tokenizes them all.

set -e

echo "make oomphc"
make oomphc

for file in tests/*.oomph builtins.oomph self_hosted/*.oomph; do
    if [ $file == tests/unterminated_string_error.oomph ] || [ $file == tests/prefix_minus_error.oomph ]; then
        # tokenizing fails, as supposed to
        continue
    fi

    command="./oomphc --ast $file"
    echo $command
    $command >/dev/null
done

echo "
================== success =================="

Bugs:
- ref cycles are not prevented or garbage collected
- new refs are not created in every case where they should be
